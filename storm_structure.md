## Структура штормового волнения

Штормовое волнение описывается не только параметрами волн, но и их динамикой за время полного штормового цикла – от их интенсивного роста в начальную стадию и до полного затухания в конце. Штормовое волнение включает три основные фазы – развития (усиление), стабилизации и затухания (ослабление). Если в стадию развития и стабилизации происходит размыв берегового профиля, то в стадию затухания происходит частичное его восстановление. Интенсивность восстановления берегового профиля зависит от продолжительности стадии затухания шторма и от того как высоты волн в эту фазу соотносятся с высотой волны стадии развития шторма. Чем длиннее фаза затухания шторма и чем более постепенно снижается высота волны в эту фазу, тем большее количество наносов будет перенесено в сторону берега к концу штормового события.

Исходными данными для исследования являются данные реанализа [ERA5](https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-single-levels?tab=form) для точки с координатами N54.5 E19, расположенной в Балтийском море у побережья Балтийской (Вислинской) косы. Исследуемый временной промежуток 42 года (1979 г – 2020 г). Частота отсчетов волновых параметров 3 часа в сутки (количество строк -  122728). Каждый отсчет включает значения Hs, м – значительная высота волны; Tm, с – средний период волн; dir, град. – румб волнения ([dataset](1979_2020.dat)). Соответствующие обозначения переменных в каталоге ERA5:

- swh - significant height of combined wind waves and swell
- mwp - mean wave period
- mwd - mean wave direction

На начальном этапе из непрерывного ряда волновых параметров извлекаются штормовые события по признаку превышения высотой волны значений 1 м ([matlab](/matlab_scripts/index_get_storm.m)). Затем полученные массивы штормовых событий можно отфильтровать по продолжительности и по интенсивности. Можно так же оставить только те штормы, для которых выделяется стадия развития или затухания (максимальное значение высоты волны не должно быть на стартовой или финальной точке). 

На начальном этапе мы получили 2263 штормовых события. В нашем случае мы выбираем только те события, для которых можно выделить стадию затухания шторма и длительность которых больше или равна 12 часов ([matlab](/matlab_scripts/choose_storm.m)). После фильтрации у нас осталось 1355 штормовых событий. Массивы всех штормовых событий могут быть для удобства упакованы в .mat файл ([matlab](/matlab_scripts/collect_month_storms.m)).

На предварительном этапе для каждого шторма определяются ряд общих метрик, которые записываются в отдельный файл ([matlab](/matlab_scripts/charact_storm_general.m)). К данным метрикам относится продолжительность шторма (T, ч), максимум, среднее значение и среднеквадратичное отклонение Hs и Tm, среднее значение и среднеквадратичное отклонение dir. Помимо этого файл содержит информацию о месяце в котором происходил шторм ([dataset](storm_char_choose_1355.txt)). Данные метрики нужны для получения общих характеристик изменения штормовой активности в течение года по месяцам. Строим распределение по месяцам максимальных значений Hs,  среднемесячных значений Hsm, средней продолжительности штормов и среднего количество штормов в каждый месяц ([python](/python_scripts/season_storm_action_analysis.ipynb)). Данный набор графиков позволяет увидеть сезонность в распределении штормовой активности.

<image
  src="/images/storm_charact_general.jpg">

  Далее для каждого шторма вычисляются метрики определяющие структуру шторма. Ранее было сказано, что чем длиннее стадия затухания волнения и чем более постепенно снижается высота волны в эту фазу, тем больше восстановительный потенциал шторма. Возникает задача - как выявить постепенное снижение волновых параметров? Одним из решений данной задачи может быть рассмотрение отношения между максимальной высотой волны шторма (Нsmax) и средним или медианным значением высоты волны в стадию затухания. Чем ближе значение данного отношения единице, тем большим потенциалом для восстановления берегового профиля обладает фаза затухания шторма. На рисунке 2 на примере 4-х штормов из исследуемого датасета показано:
  - изменение $Hs$ во время шторма;
  - значение $Нs_{max}$ для каждого шторма;
  - значения метрики:
  $$R = {Нs_{max}\over Нs_{ср}}$$
    для каждого шторма;
  - средние $Hs_{ср}$ и  медианные $Hs_{м}$ значения $Hs$ за время стадии затухания для каждого шторма.
  
<image
  src="/images/4_storms.jpg">
  
  Для получения необходимых характеристик штормов используется скрипт [matlab](/matlab_scripts/charact_storm.m). В качестве исходных данных используется файл [.mat](all_storms.mat), описывающие все выделенные шторы на предварительном этапе. В дальнейшем расчет значений R и статистический анализ распределения этой метрики по месяцам и отдельным сезонам осуществляется в скрипте python.
